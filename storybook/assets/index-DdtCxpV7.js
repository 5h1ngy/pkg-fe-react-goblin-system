import{a as re,P as K,f as ae,M as oe,N as ce,H as ue,r as k,y as C,l as le,Q as w,R as V,S as A,z as F,T as de,h as G,U as S,V as $,W as te,X as se,Y as he,Z as fe,_ as pe,t as be,$ as O,a0 as P,a1 as me,a2 as ye,a3 as ge}from"./use-environment-context-C3WQxcjj.js";import{r as ve}from"./index-CFahbR6w.js";function Ne(e,t,n){const s=e.matches("mounted","unmountSuspended");return{skip:!e.context.initial&&s,present:s,setNode(i){i&&t({type:"NODE.SET",node:i})},unmount(){t({type:"UNMOUNT"})}}}function Ee(e){return re({initial:e.present?"mounted":"unmounted",context:{node:null,styles:null,unmountAnimationName:null,prevAnimationName:null,present:!1,initial:!1,...e},exit:["clearInitial","cleanupNode"],watch:{present:["setInitial","syncPresence"]},on:{"NODE.SET":{actions:["setNode","setStyles"]}},states:{mounted:{on:{UNMOUNT:{target:"unmounted",actions:["invokeOnExitComplete"]},"UNMOUNT.SUSPEND":"unmountSuspended"}},unmountSuspended:{activities:["trackAnimationEvents"],after:{ANIMATION_DURATION:{target:"unmounted",actions:["invokeOnExitComplete"]}},on:{MOUNT:{target:"mounted",actions:["setPrevAnimationName"]},UNMOUNT:{target:"unmounted",actions:["invokeOnExitComplete"]}}},unmounted:{entry:["clearPrevAnimationName"],on:{MOUNT:{target:"mounted",actions:["setPrevAnimationName"]}}}}},{delays:{ANIMATION_DURATION(t){var n,s;return H((n=t.styles)==null?void 0:n.animationDuration)+H((s=t.styles)==null?void 0:s.animationDelay)+we}},actions:{setInitial(t){t.initial=!0},clearInitial(t){t.initial=!1},cleanupNode(t){t.node=null,t.styles=null},invokeOnExitComplete(t){var n;(n=t.onExitComplete)==null||n.call(t)},setNode(t,n){t.node=K(n.node)},setStyles(t,n){const s=n.node.ownerDocument.defaultView||window;t.styles=K(s.getComputedStyle(n.node))},syncPresence(t,n,{send:s}){var a;if(t.present){s({type:"MOUNT",src:"presence.changed"});return}if(!t.present&&((a=t.node)==null?void 0:a.ownerDocument.visibilityState)==="hidden"){s({type:"UNMOUNT",src:"visibilitychange"});return}const i=D(t.styles);(t.immediate?queueMicrotask:requestAnimationFrame)(()=>{var c,h;t.unmountAnimationName=i,i==="none"||i===t.prevAnimationName||((c=t.styles)==null?void 0:c.display)==="none"||((h=t.styles)==null?void 0:h.animationDuration)==="0s"?s({type:"UNMOUNT",src:"presence.changed"}):s({type:"UNMOUNT.SUSPEND"})})},setPrevAnimationName(t){(t.immediate?queueMicrotask:requestAnimationFrame)(()=>{t.prevAnimationName=D(t.styles)})},clearPrevAnimationName(t){t.prevAnimationName=null}},activities:{trackAnimationEvents(t,n,{send:s}){const i=t.node;if(!i)return;const r=c=>{var o,l;(((l=(o=c.composedPath)==null?void 0:o.call(c))==null?void 0:l[0])??c.target)===i&&(t.prevAnimationName=D(t.styles))},a=c=>{var l,b;const h=D(t.styles);(((b=(l=c.composedPath)==null?void 0:l.call(c))==null?void 0:b[0])??c.target)===i&&h===t.unmountAnimationName&&s({type:"UNMOUNT",src:"animationend"})};return i.addEventListener("animationstart",r),i.addEventListener("animationcancel",a),i.addEventListener("animationend",a),()=>{i.removeEventListener("animationstart",r),i.removeEventListener("animationcancel",a),i.removeEventListener("animationend",a)}}}})}function D(e){return(e==null?void 0:e.animationName)||"none"}function H(e){return parseFloat(e||"0")*1e3}var we=16.667;ae()(["onExitComplete","present","immediate"]);const je=e=>{const{lazyMount:t,unmountOnExit:n,present:s,...i}=e,r=ve.useRef(!1),a={...i,present:s,onExitComplete:oe(e.onExitComplete)},[c,h]=ce(Ee(a),{context:a}),o=Ne(c,h);o.present&&(r.current=!0);const l=!o.present&&!r.current&&t||n&&!o.present&&r.current,b=()=>({"data-state":s?"open":"closed",hidden:!o.present});return{ref:o.setNode,getPresenceProps:b,present:o.present,unmounted:l}},[Qe,Ze]=ue({name:"PresenceContext",hookName:"usePresenceContext",providerName:"<PresenceProvider />"});function Fe(e){const t={each(n){var s;for(let i=0;i<((s=e.frames)==null?void 0:s.length);i+=1){const r=e.frames[i];r&&n(r)}},addEventListener(n,s,i){return t.each(r=>{try{r.document.addEventListener(n,s,i)}catch{}}),()=>{try{t.removeEventListener(n,s,i)}catch{}}},removeEventListener(n,s,i){t.each(r=>{try{r.document.removeEventListener(n,s,i)}catch{}})}};return t}function Oe(e){const t=e.frameElement!=null?e.parent:null;return{addEventListener:(n,s,i)=>{try{t==null||t.addEventListener(n,s,i)}catch{}return()=>{try{t==null||t.removeEventListener(n,s,i)}catch{}}},removeEventListener:(n,s,i)=>{try{t==null||t.removeEventListener(n,s,i)}catch{}}}}var Y="pointerdown.outside",X="focus.outside";function Te(e){for(const t of e)if(G(t)&&A(t))return!0;return!1}var ne=e=>"clientY"in e;function ke(e,t){if(!ne(t)||!e)return!1;const n=e.getBoundingClientRect();return n.width===0||n.height===0?!1:n.top<=t.clientY&&t.clientY<=n.top+n.height&&n.left<=t.clientX&&t.clientX<=n.left+n.width}function Pe(e,t){return e.y<=t.y&&t.y<=e.y+e.height&&e.x<=t.x&&t.x<=e.x+e.width}function q(e,t){if(!t||!ne(e))return!1;const n=t.scrollHeight>t.clientHeight,s=n&&e.clientX>t.offsetLeft+t.clientWidth,i=t.scrollWidth>t.clientWidth,r=i&&e.clientY>t.offsetTop+t.clientHeight,a={x:t.offsetLeft,y:t.offsetTop,width:t.clientWidth+(n?16:0),height:t.clientHeight+(i?16:0)},c={x:e.clientX,y:e.clientY};return Pe(a,c)?s||r:!1}function xe(e,t){const{exclude:n,onFocusOutside:s,onPointerDownOutside:i,onInteractOutside:r,defer:a}=t;if(!e)return;const c=C(e),h=le(e),o=Fe(h),l=Oe(h);function b(p){const g=F(p);if(!G(g)||!g.isConnected||S(e,g)||ke(e,p))return!1;const E=c.querySelector(`[aria-controls="${e.id}"]`);if(E){const L=$(E);if(q(p,L))return!1}const R=$(e);return q(p,R)?!1:!(n!=null&&n(g))}const u=new Set;function f(p){function g(){var L;const E=a?k:U=>U(),R=((L=p.composedPath)==null?void 0:L.call(p))??[p.target];E(()=>{if(!(!e||!b(p))){if(i||r){const U=V(i,r);e.addEventListener(Y,U,{once:!0})}z(e,Y,{bubbles:!1,cancelable:!0,detail:{originalEvent:p,contextmenu:de(p),focusable:Te(R)}})}})}p.pointerType==="touch"?(u.forEach(E=>E()),u.add(w(c,"click",g,{once:!0})),u.add(l.addEventListener("click",g,{once:!0})),u.add(o.addEventListener("click",g,{once:!0}))):g()}const d=new Set,y=setTimeout(()=>{d.add(w(c,"pointerdown",f,!0)),d.add(l.addEventListener("pointerdown",f,!0)),d.add(o.addEventListener("pointerdown",f,!0))},0);function N(p){(a?k:E=>E())(()=>{if(!(!e||!b(p))){if(s||r){const E=V(s,r);e.addEventListener(X,E,{once:!0})}z(e,X,{bubbles:!1,cancelable:!0,detail:{originalEvent:p,contextmenu:!1,focusable:A(F(p))}})}})}return d.add(w(c,"focusin",N,!0)),d.add(l.addEventListener("focusin",N,!0)),d.add(o.addEventListener("focusin",N,!0)),()=>{clearTimeout(y),u.forEach(p=>p()),d.forEach(p=>p())}}function Ie(e,t){const{defer:n}=t,s=n?k:r=>r(),i=[];return i.push(s(()=>{const r=typeof e=="function"?e():e;i.push(xe(r,t))})),()=>{i.forEach(r=>r==null?void 0:r())}}function z(e,t,n){const s=e.ownerDocument.defaultView||window,i=new s.CustomEvent(t,n);return e.dispatchEvent(i)}function Ae(e,t){const n=s=>{s.key==="Escape"&&(s.isComposing||t==null||t(s))};return w(C(e),"keydown",n,{capture:!0})}var v={layers:[],branches:[],count(){return this.layers.length},pointerBlockingLayers(){return this.layers.filter(e=>e.pointerBlocking)},topMostPointerBlockingLayer(){return[...this.pointerBlockingLayers()].slice(-1)[0]},hasPointerBlockingLayer(){return this.pointerBlockingLayers().length>0},isBelowPointerBlockingLayer(e){var s;const t=this.indexOf(e),n=this.topMostPointerBlockingLayer()?this.indexOf((s=this.topMostPointerBlockingLayer())==null?void 0:s.node):-1;return t<n},isTopMost(e){const t=this.layers[this.count()-1];return(t==null?void 0:t.node)===e},getNestedLayers(e){return Array.from(this.layers).slice(this.indexOf(e)+1)},isInNestedLayer(e,t){return this.getNestedLayers(e).some(n=>S(n.node,t))},isInBranch(e){return Array.from(this.branches).some(t=>S(t,e))},add(e){const t=this.layers.push(e);e.node.style.setProperty("--layer-index",`${t}`)},addBranch(e){this.branches.push(e)},remove(e){const t=this.indexOf(e);t<0||(t<this.count()-1&&this.getNestedLayers(e).forEach(s=>s.dismiss()),this.layers.splice(t,1),e.style.removeProperty("--layer-index"))},removeBranch(e){const t=this.branches.indexOf(e);t>=0&&this.branches.splice(t,1)},indexOf(e){return this.layers.findIndex(t=>t.node===e)},dismiss(e){var t;(t=this.layers[this.indexOf(e)])==null||t.dismiss()},clear(){this.remove(this.layers[0].node)}},j;function Q(){v.layers.forEach(({node:e})=>{e.style.pointerEvents=v.isBelowPointerBlockingLayer(e)?"none":"auto"})}function Ce(e){e.style.pointerEvents=""}function Le(e,t){const n=C(e),s=[];if(v.hasPointerBlockingLayer()&&!n.body.hasAttribute("data-inert")&&(j=document.body.style.pointerEvents,queueMicrotask(()=>{n.body.style.pointerEvents="none",n.body.setAttribute("data-inert","")})),t){const i=he(t,r=>{s.push(fe(r,{pointerEvents:"auto"}))});s.push(i)}return()=>{v.hasPointerBlockingLayer()||(queueMicrotask(()=>{n.body.style.pointerEvents=j,n.body.removeAttribute("data-inert"),n.body.style.length===0&&n.body.removeAttribute("style")}),s.forEach(i=>i()))}}function De(e,t){if(!e){se("[@zag-js/dismissable] node is `null` or `undefined`");return}const{onDismiss:n,pointerBlocking:s,exclude:i,debug:r}=t,a={dismiss:n,node:e,pointerBlocking:s};v.add(a),Q();function c(u){var d,y;const f=F(u.detail.originalEvent);v.isBelowPointerBlockingLayer(e)||v.isInBranch(f)||((d=t.onPointerDownOutside)==null||d.call(t,u),(y=t.onInteractOutside)==null||y.call(t,u),!u.defaultPrevented&&(r&&console.log("onPointerDownOutside:",u.detail.originalEvent),n==null||n()))}function h(u){var d,y;const f=F(u.detail.originalEvent);v.isInBranch(f)||((d=t.onFocusOutside)==null||d.call(t,u),(y=t.onInteractOutside)==null||y.call(t,u),!u.defaultPrevented&&(r&&console.log("onFocusOutside:",u.detail.originalEvent),n==null||n()))}function o(u){var f;v.isTopMost(e)&&((f=t.onEscapeKeyDown)==null||f.call(t,u),!u.defaultPrevented&&n&&(u.preventDefault(),n()))}function l(u){var N;if(!e)return!1;const f=typeof i=="function"?i():i,d=Array.isArray(f)?f:[f],y=(N=t.persistentElements)==null?void 0:N.map(p=>p()).filter(G);return y&&d.push(...y),d.some(p=>S(p,u))||v.isInNestedLayer(e,u)}const b=[s?Le(e,t.persistentElements):void 0,Ae(e,o),Ie(e,{exclude:l,onFocusOutside:h,onPointerDownOutside:c,defer:t.defer})];return()=>{v.remove(e),Q(),Ce(e),b.forEach(u=>u==null?void 0:u())}}function Je(e,t){const{defer:n}=t,s=n?k:r=>r(),i=[];return i.push(s(()=>{const r=te(e)?e():e;i.push(De(r,t))})),()=>{i.forEach(r=>r==null?void 0:r())}}function et(e,t={}){const{defer:n}=t,s=n?k:r=>r(),i=[];return i.push(s(()=>{const r=te(e)?e():e;if(!r){se("[@zag-js/dismissable] branch node is `null` or `undefined`");return}v.addBranch(r),i.push(()=>{v.removeBranch(r)})})),()=>{i.forEach(r=>r==null?void 0:r())}}var T=new WeakMap,B=new WeakMap,M={},_=0,ie=e=>e&&(e.host||ie(e.parentNode)),Be=(e,t)=>t.map(n=>{if(e.contains(n))return n;const s=ie(n);return s&&e.contains(s)?s:(console.error("[zag-js > ariaHidden] target",n,"in not contained inside",e,". Doing nothing"),null)}).filter(n=>!!n),Me=e=>e.localName==="next-route-announcer"||e.localName==="script"||e.hasAttribute("aria-live")?!0:e.matches("[data-live-announcer]"),Se=(e,t)=>{const{parentNode:n,markerName:s,controlAttribute:i,explicitBooleanValue:r}=t,a=Be(n,Array.isArray(e)?e:[e]);M[s]||(M[s]=new WeakMap);const c=M[s],h=[],o=new Set,l=new Set(a),b=f=>{!f||o.has(f)||(o.add(f),b(f.parentNode))};a.forEach(b);const u=f=>{!f||l.has(f)||Array.prototype.forEach.call(f.children,d=>{if(o.has(d))u(d);else try{if(Me(d))return;const y=d.getAttribute(i),N=r?y==="true":y!==null&&y!=="false",p=(T.get(d)||0)+1,g=(c.get(d)||0)+1;T.set(d,p),c.set(d,g),h.push(d),p===1&&N&&B.set(d,!0),g===1&&d.setAttribute(s,""),N||d.setAttribute(i,r?"true":"")}catch(y){console.error("[zag-js > ariaHidden] cannot operate on ",d,y)}})};return u(n),o.clear(),_++,()=>{h.forEach(f=>{const d=T.get(f)-1,y=c.get(f)-1;T.set(f,d),c.set(f,y),d||(B.has(f)||f.removeAttribute(i),B.delete(f)),y||f.removeAttribute(s)}),_--,_||(T=new WeakMap,T=new WeakMap,B=new WeakMap,M={})}},Re=e=>(Array.isArray(e)?e[0]:e).ownerDocument.body,Ue=(e,t=Re(e),n="data-aria-hidden")=>{if(t)return Se(e,{parentNode:t,markerName:n,controlAttribute:"aria-hidden",explicitBooleanValue:!0})},_e=e=>{const t=requestAnimationFrame(()=>e());return()=>cancelAnimationFrame(t)};function tt(e,t={}){const{defer:n=!0}=t,s=n?_e:r=>r(),i=[];return i.push(s(()=>{const a=(typeof e=="function"?e():e).filter(Boolean);a.length!==0&&i.push(Ue(a))})),()=>{i.forEach(r=>r==null?void 0:r())}}var We=Object.defineProperty,Ge=(e,t,n)=>t in e?We(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,m=(e,t,n)=>Ge(e,typeof t!="symbol"?t+"":t,n),Z={activateTrap(e,t){if(e.length>0){const s=e[e.length-1];s!==t&&s.pause()}const n=e.indexOf(t);n===-1||e.splice(n,1),e.push(t)},deactivateTrap(e,t){const n=e.indexOf(t);n!==-1&&e.splice(n,1),e.length>0&&e[e.length-1].unpause()}},Ke=[],Ve=class{constructor(e,t){m(this,"trapStack"),m(this,"config"),m(this,"doc"),m(this,"state",{containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,delayInitialFocusTimer:void 0,recentNavEvent:void 0}),m(this,"listenerCleanups",[]),m(this,"handleFocus",s=>{const i=F(s),r=this.findContainerIndex(i,s)>=0;if(r||me(i))r&&(this.state.mostRecentlyFocusedNode=i);else{s.stopImmediatePropagation();let a,c=!0;if(this.state.mostRecentlyFocusedNode)if(P(this.state.mostRecentlyFocusedNode)>0){const h=this.findContainerIndex(this.state.mostRecentlyFocusedNode),{tabbableNodes:o}=this.state.containerGroups[h];if(o.length>0){const l=o.findIndex(b=>b===this.state.mostRecentlyFocusedNode);l>=0&&(this.config.isKeyForward(this.state.recentNavEvent)?l+1<o.length&&(a=o[l+1],c=!1):l-1>=0&&(a=o[l-1],c=!1))}}else this.state.containerGroups.some(h=>h.tabbableNodes.some(o=>P(o)>0))||(c=!1);else c=!1;c&&(a=this.findNextNavNode({target:this.state.mostRecentlyFocusedNode,isBackward:this.config.isKeyBackward(this.state.recentNavEvent)})),a?this.tryFocus(a):this.tryFocus(this.state.mostRecentlyFocusedNode||this.getInitialFocusNode())}this.state.recentNavEvent=void 0}),m(this,"handlePointerDown",s=>{const i=F(s);if(!(this.findContainerIndex(i,s)>=0)){if(I(this.config.clickOutsideDeactivates,s)){this.deactivate({returnFocus:this.config.returnFocusOnDeactivate});return}I(this.config.allowOutsideClick,s)||s.preventDefault()}}),m(this,"handleClick",s=>{const i=F(s);this.findContainerIndex(i,s)>=0||I(this.config.clickOutsideDeactivates,s)||I(this.config.allowOutsideClick,s)||(s.preventDefault(),s.stopImmediatePropagation())}),m(this,"handleTabKey",s=>{if(this.config.isKeyForward(s)||this.config.isKeyBackward(s)){this.state.recentNavEvent=s;const i=this.config.isKeyBackward(s),r=this.findNextNavNode({event:s,isBackward:i});if(!r)return;x(s)&&s.preventDefault(),this.tryFocus(r)}}),m(this,"handleEscapeKey",s=>{$e(s)&&I(this.config.escapeDeactivates,s)!==!1&&(s.preventDefault(),this.deactivate())}),m(this,"_mutationObserver"),m(this,"setupMutationObserver",()=>{const s=this.doc.defaultView||window;this._mutationObserver=new s.MutationObserver(i=>{i.some(a=>Array.from(a.removedNodes).some(h=>h===this.state.mostRecentlyFocusedNode))&&this.tryFocus(this.getInitialFocusNode())})}),m(this,"updateObservedNodes",()=>{var s;(s=this._mutationObserver)==null||s.disconnect(),this.state.active&&!this.state.paused&&this.state.containers.map(i=>{var r;(r=this._mutationObserver)==null||r.observe(i,{subtree:!0,childList:!0})})}),m(this,"getInitialFocusNode",()=>{let s=this.getNodeForOption("initialFocus",{hasFallback:!0});if(s===!1)return!1;if(s===void 0||s&&!A(s))if(this.findContainerIndex(this.doc.activeElement)>=0)s=this.doc.activeElement;else{const i=this.state.tabbableGroups[0];s=i&&i.firstTabbableNode||this.getNodeForOption("fallbackFocus")}else s===null&&(s=this.getNodeForOption("fallbackFocus"));if(!s)throw new Error("Your focus-trap needs to have at least one focusable element");return s.isConnected||(s=this.getNodeForOption("fallbackFocus")),s}),m(this,"tryFocus",s=>{if(s!==!1&&s!==ye(this.doc)){if(!s||!s.focus){this.tryFocus(this.getInitialFocusNode());return}s.focus({preventScroll:!!this.config.preventScroll}),this.state.mostRecentlyFocusedNode=s,He(s)&&s.select()}}),m(this,"deactivate",s=>{if(!this.state.active)return this;const i={onDeactivate:this.config.onDeactivate,onPostDeactivate:this.config.onPostDeactivate,checkCanReturnFocus:this.config.checkCanReturnFocus,...s};clearTimeout(this.state.delayInitialFocusTimer),this.state.delayInitialFocusTimer=void 0,this.removeListeners(),this.state.active=!1,this.state.paused=!1,this.updateObservedNodes(),Z.deactivateTrap(this.trapStack,this);const r=this.getOption(i,"onDeactivate"),a=this.getOption(i,"onPostDeactivate"),c=this.getOption(i,"checkCanReturnFocus"),h=this.getOption(i,"returnFocus","returnFocusOnDeactivate");r==null||r();const o=()=>{J(()=>{if(h){const l=this.getReturnFocusNode(this.state.nodeFocusedBeforeActivation);this.tryFocus(l)}a==null||a()})};if(h&&c){const l=this.getReturnFocusNode(this.state.nodeFocusedBeforeActivation);return c(l).then(o,o),this}return o(),this}),m(this,"pause",s=>{if(this.state.paused||!this.state.active)return this;const i=this.getOption(s,"onPause"),r=this.getOption(s,"onPostPause");return this.state.paused=!0,i==null||i(),this.removeListeners(),this.updateObservedNodes(),r==null||r(),this}),m(this,"unpause",s=>{if(!this.state.paused||!this.state.active)return this;const i=this.getOption(s,"onUnpause"),r=this.getOption(s,"onPostUnpause");return this.state.paused=!1,i==null||i(),this.updateTabbableNodes(),this.addListeners(),this.updateObservedNodes(),r==null||r(),this}),m(this,"updateContainerElements",s=>(this.state.containers=Array.isArray(s)?s.filter(Boolean):[s].filter(Boolean),this.state.active&&this.updateTabbableNodes(),this.updateObservedNodes(),this)),m(this,"getReturnFocusNode",s=>{const i=this.getNodeForOption("setReturnFocus",{params:[s]});return i||(i===!1?!1:s)}),m(this,"getOption",(s,i,r)=>s&&s[i]!==void 0?s[i]:this.config[r||i]),m(this,"getNodeForOption",(s,{hasFallback:i=!1,params:r=[]}={})=>{let a=this.config[s];if(typeof a=="function"&&(a=a(...r)),a===!0&&(a=void 0),!a){if(a===void 0||a===!1)return a;throw new Error(`\`${s}\` was specified but was not a node, or did not return a node`)}let c=a;if(typeof a=="string"){try{c=this.doc.querySelector(a)}catch(h){throw new Error(`\`${s}\` appears to be an invalid selector; error="${h.message}"`)}if(!c&&!i)throw new Error(`\`${s}\` as selector refers to no known node`)}return c}),m(this,"findNextNavNode",s=>{const{event:i,isBackward:r=!1}=s,a=s.target||F(i);this.updateTabbableNodes();let c=null;if(this.state.tabbableGroups.length>0){const h=this.findContainerIndex(a,i),o=h>=0?this.state.containerGroups[h]:void 0;if(h<0)r?c=this.state.tabbableGroups[this.state.tabbableGroups.length-1].lastTabbableNode:c=this.state.tabbableGroups[0].firstTabbableNode;else if(r){let l=this.state.tabbableGroups.findIndex(({firstTabbableNode:b})=>a===b);if(l<0&&((o==null?void 0:o.container)===a||A(a)&&!O(a)&&!(o!=null&&o.nextTabbableNode(a,!1)))&&(l=h),l>=0){const b=l===0?this.state.tabbableGroups.length-1:l-1,u=this.state.tabbableGroups[b];c=P(a)>=0?u.lastTabbableNode:u.lastDomTabbableNode}else x(i)||(c=o==null?void 0:o.nextTabbableNode(a,!1))}else{let l=this.state.tabbableGroups.findIndex(({lastTabbableNode:b})=>a===b);if(l<0&&((o==null?void 0:o.container)===a||A(a)&&!O(a)&&!(o!=null&&o.nextTabbableNode(a)))&&(l=h),l>=0){const b=l===this.state.tabbableGroups.length-1?0:l+1,u=this.state.tabbableGroups[b];c=P(a)>=0?u.firstTabbableNode:u.firstDomTabbableNode}else x(i)||(c=o==null?void 0:o.nextTabbableNode(a))}}else c=this.getNodeForOption("fallbackFocus");return c}),this.trapStack=t.trapStack||Ke;const n={returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0,isKeyForward(s){return x(s)&&!s.shiftKey},isKeyBackward(s){return x(s)&&s.shiftKey},...t};this.doc=n.document||C(Array.isArray(e)?e[0]:e),this.config=n,this.updateContainerElements(e),this.setupMutationObserver()}get active(){return this.state.active}get paused(){return this.state.paused}findContainerIndex(e,t){const n=typeof(t==null?void 0:t.composedPath)=="function"?t.composedPath():void 0;return this.state.containerGroups.findIndex(({container:s,tabbableNodes:i})=>s.contains(e)||(n==null?void 0:n.includes(s))||i.find(r=>r===e))}updateTabbableNodes(){if(this.state.containerGroups=this.state.containers.map(e=>{const t=pe(e),n=be(e),s=t.length>0?t[0]:void 0,i=t.length>0?t[t.length-1]:void 0,r=n.find(o=>O(o)),a=n.slice().reverse().find(o=>O(o)),c=!!t.find(o=>P(o)>0);function h(o,l=!0){const b=t.indexOf(o);return b<0?l?n.slice(n.indexOf(o)+1).find(u=>O(u)):n.slice(0,n.indexOf(o)).reverse().find(u=>O(u)):t[b+(l?1:-1)]}return{container:e,tabbableNodes:t,focusableNodes:n,posTabIndexesFound:c,firstTabbableNode:s,lastTabbableNode:i,firstDomTabbableNode:r,lastDomTabbableNode:a,nextTabbableNode:h}}),this.state.tabbableGroups=this.state.containerGroups.filter(e=>e.tabbableNodes.length>0),this.state.tabbableGroups.length<=0&&!this.getNodeForOption("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times");if(this.state.containerGroups.find(e=>e.posTabIndexesFound)&&this.state.containerGroups.length>1)throw new Error("At least one node with a positive tabindex was found in one of your focus-trap's multiple containers. Positive tabindexes are only supported in single-container focus-traps.")}addListeners(){if(this.state.active)return Z.activateTrap(this.trapStack,this),this.state.delayInitialFocusTimer=this.config.delayInitialFocus?J(()=>{this.tryFocus(this.getInitialFocusNode())}):this.tryFocus(this.getInitialFocusNode()),this.listenerCleanups.push(w(this.doc,"focusin",this.handleFocus,!0),w(this.doc,"mousedown",this.handlePointerDown,{capture:!0,passive:!1}),w(this.doc,"touchstart",this.handlePointerDown,{capture:!0,passive:!1}),w(this.doc,"click",this.handleClick,{capture:!0,passive:!1}),w(this.doc,"keydown",this.handleTabKey,{capture:!0,passive:!1}),w(this.doc,"keydown",this.handleEscapeKey)),this}removeListeners(){if(this.state.active)return this.listenerCleanups.forEach(e=>e()),this.listenerCleanups=[],this}activate(e){if(this.state.active)return this;const t=this.getOption(e,"onActivate"),n=this.getOption(e,"onPostActivate"),s=this.getOption(e,"checkCanFocusTrap");s||this.updateTabbableNodes(),this.state.active=!0,this.state.paused=!1,this.state.nodeFocusedBeforeActivation=this.doc.activeElement||null,t==null||t();const i=()=>{s&&this.updateTabbableNodes(),this.addListeners(),this.updateObservedNodes(),n==null||n()};return s?(s(this.state.containers.concat()).then(i,i),this):(i(),this)}},x=e=>e.key==="Tab",I=(e,...t)=>typeof e=="function"?e(...t):e,$e=e=>!e.isComposing&&e.key==="Escape",J=e=>setTimeout(e,0),He=e=>e.localName==="input"&&"select"in e&&typeof e.select=="function";function st(e,t={}){let n;const s=k(()=>{const i=typeof e=="function"?e():e;if(i){n=new Ve(i,{escapeDeactivates:!1,allowOutsideClick:!0,preventScroll:!0,returnFocusOnDeactivate:!0,delayInitialFocus:!1,fallbackFocus:i,...t,document:C(i)});try{n.activate()}catch{}}});return function(){n==null||n.deactivate(),s()}}var W="data-scroll-lock";function ee(e,t){if(!e)return;const n=Object.keys(t).reduce((s,i)=>(s[i]=e.style.getPropertyValue(i),s),{});return Object.assign(e.style,t),()=>{Object.assign(e.style,n)}}function Ye(e,t,n){if(!e)return;const s=e.style.getPropertyValue(t);return e.style.setProperty(t,n),()=>{s?e.style.setProperty(t,s):e.style.removeProperty(t)}}function Xe(e){const t=e.getBoundingClientRect().left;return Math.round(t)+e.scrollLeft?"paddingLeft":"paddingRight"}function nt(e){const t=e??document,n=t.defaultView??window,{documentElement:s,body:i}=t;if(i.hasAttribute(W))return;i.setAttribute(W,"");const a=n.innerWidth-s.clientWidth,c=()=>Ye(s,"--scrollbar-width",`${a}px`),h=Xe(s),o=()=>ee(i,{overflow:"hidden",[h]:`${a}px`}),l=()=>{const{scrollX:u,scrollY:f,visualViewport:d}=n,y=(d==null?void 0:d.offsetLeft)??0,N=(d==null?void 0:d.offsetTop)??0,p=ee(i,{position:"fixed",overflow:"hidden",top:`${-(f-Math.floor(N))}px`,left:`${-(u-Math.floor(y))}px`,right:"0",[h]:`${a}px`});return()=>{p==null||p(),n.scrollTo({left:u,top:f,behavior:"instant"})}},b=[c(),ge()?l():o()];return()=>{b.forEach(u=>u==null?void 0:u()),i.removeAttribute(W)}}export{Qe as P,tt as a,Je as b,je as c,et as d,nt as p,st as t,Ze as u};
