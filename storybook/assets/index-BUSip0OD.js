import{r as h,n as L,h as M,j as B,k as R,l as N,m as x,c as S,a as G,b as z,p as H,e as W,q as V,s as j,t as _,u as I,f as K}from"./use-environment-context-KKmzfobL.js";import{a as U,o as q,f as J,s as Y,b as Q,c as X,h as Z,d as ee,l as te}from"./floating-ui.dom-DTz9C7ph.js";import{t as re,p as ne,a as oe,b as ie}from"./index-CYPJOs-1.js";function C(e=0,r=0,t=0,n=0){if(typeof DOMRect=="function")return new DOMRect(e,r,t,n);const o={x:e,y:r,width:t,height:n,top:r,right:e+t,bottom:r+n,left:e};return{...o,toJSON:()=>o}}function se(e){if(!e)return C();const{x:r,y:t,width:n,height:o}=e;return C(r,t,n,o)}function ae(e,r){return{contextElement:M(e)?e:void 0,getBoundingClientRect:()=>{const t=e,n=r==null?void 0:r(t);return n||!t?se(n):t.getBoundingClientRect()}}}var f=e=>({variable:e,reference:`var(${e})`}),p={arrowSize:f("--arrow-size"),arrowSizeHalf:f("--arrow-size-half"),arrowBg:f("--arrow-background"),transformOrigin:f("--transform-origin"),arrowOffset:f("--arrow-offset")},le=e=>({top:"bottom center","top-start":e?`${e.x}px bottom`:"left bottom","top-end":e?`${e.x}px bottom`:"right bottom",bottom:"top center","bottom-start":e?`${e.x}px top`:"top left","bottom-end":e?`${e.x}px top`:"top right",left:"right center","left-start":e?`right ${e.y}px`:"right top","left-end":e?`right ${e.y}px`:"right bottom",right:"left center","right-start":e?`left ${e.y}px`:"left top","right-end":e?`left ${e.y}px`:"left bottom"}),de={name:"transformOrigin",fn({placement:e,elements:r,middlewareData:t}){const{arrow:n}=t,o=le(n)[e],{floating:s}=r;return s.style.setProperty(p.transformOrigin.variable,o),{data:{transformOrigin:o}}}},ce={name:"rects",fn({rects:e}){return{data:e}}},ue=e=>{if(e)return{name:"shiftArrow",fn({placement:r,middlewareData:t}){if(!t.arrow)return{};const{x:n,y:o}=t.arrow,s=r.split("-")[0];return Object.assign(e.style,{left:n!=null?`${n}px`:"",top:o!=null?`${o}px`:"",[s]:`calc(100% + ${p.arrowOffset.reference})`}),{}}}};function pe(e){const[r,t]=e.split("-");return{side:r,align:t,hasAlign:t!=null}}var ge={strategy:"absolute",placement:"bottom",listeners:!0,gutter:8,flip:!0,slide:!0,overlap:!1,sameWidth:!1,fitViewport:!1,overflowPadding:8,arrowPadding:4};function T(e,r){const t=e.devicePixelRatio||1;return Math.round(r*t)/t}function D(e){return R(e.boundary)}function fe(e,r){if(e)return Q({element:e,padding:r.arrowPadding})}function me(e,r){if(!B(r.offset??r.gutter))return q(({placement:t})=>{var g,c;const n=((e==null?void 0:e.clientHeight)||0)/2,o=((g=r.offset)==null?void 0:g.mainAxis)??r.gutter,s=typeof o=="number"?o+n:o??n,{hasAlign:d}=pe(t),a=d?void 0:r.shift,l=((c=r.offset)==null?void 0:c.crossAxis)??a;return S({crossAxis:l,mainAxis:s,alignmentAxis:r.shift})})}function he(e){if(e.flip)return J({boundary:D(e),padding:e.overflowPadding,fallbackPlacements:e.flip===!0?void 0:e.flip})}function Ee(e){if(!(!e.slide&&!e.overlap))return Y({boundary:D(e),mainAxis:e.slide,crossAxis:e.overlap,padding:e.overflowPadding,limiter:te()})}function Oe(e){return X({padding:e.overflowPadding,apply({elements:r,rects:t,availableHeight:n,availableWidth:o}){const s=r.floating,d=Math.round(t.reference.width);o=Math.floor(o),n=Math.floor(n),s.style.setProperty("--reference-width",`${d}px`),s.style.setProperty("--available-width",`${o}px`),s.style.setProperty("--available-height",`${n}px`)}})}function ye(e){var r;if(e.hideWhenDetached)return Z({strategy:"referenceHidden",boundary:((r=e.boundary)==null?void 0:r.call(e))??"clippingAncestors"})}function ve(e){return e?e===!0?{ancestorResize:!0,ancestorScroll:!0,elementResize:!0,layoutShift:!0}:e:{}}function Pe(e,r,t={}){const n=ae(e,t.getAnchorRect);if(!r||!n)return;const o=Object.assign({},ge,t),s=r.querySelector("[data-part=arrow]"),d=[me(s,o),he(o),Ee(o),fe(s,o),ue(s),de,Oe(o),ye(o),ce],{placement:a,strategy:l,onComplete:g,onPositioned:c}=o,O=async()=>{var b;if(!n||!r)return;const m=await ee(n,r,{placement:a,middleware:d,strategy:l});g==null||g(m),c==null||c({placed:!0});const v=N(r),A=T(v,m.x),k=T(v,m.y);r.style.setProperty("--x",`${A}px`),r.style.setProperty("--y",`${k}px`),o.hideWhenDetached&&(((b=m.middlewareData.hide)==null?void 0:b.referenceHidden)?(r.style.setProperty("visibility","hidden"),r.style.setProperty("pointer-events","none")):(r.style.removeProperty("visibility"),r.style.removeProperty("pointer-events")));const P=r.firstElementChild;if(P){const w=x(P);r.style.setProperty("--z-index",w.zIndex)}},y=async()=>{t.updatePosition?(await t.updatePosition({updatePosition:O}),c==null||c({placed:!0})):await O()},$=ve(o.listeners),E=o.listeners?U(n,r,y,$):L;return y(),()=>{E==null||E(),c==null||c({placed:!1})}}function F(e,r,t={}){const{defer:n,...o}=t,s=n?h:a=>a(),d=[];return d.push(s(()=>{const a=typeof e=="function"?e():e,l=typeof r=="function"?r():r;d.push(Pe(a,l,o))})),()=>{d.forEach(a=>a==null?void 0:a())}}var be={bottom:"rotate(45deg)",left:"rotate(135deg)",top:"rotate(225deg)",right:"rotate(315deg)"};function we(e={}){const{placement:r,sameWidth:t,fitViewport:n,strategy:o="absolute"}=e;return{arrow:{position:"absolute",width:p.arrowSize.reference,height:p.arrowSize.reference,[p.arrowSizeHalf.variable]:`calc(${p.arrowSize.reference} / 2)`,[p.arrowOffset.variable]:`calc(${p.arrowSizeHalf.reference} * -1)`},arrowTip:{transform:r?be[r.split("-")[0]]:void 0,background:p.arrowBg.reference,top:"0",left:"0",width:"100%",height:"100%",position:"absolute",zIndex:"inherit"},floating:{position:o,isolation:"isolate",minWidth:t?void 0:"max-content",width:t?"var(--reference-width)":void 0,maxWidth:n?"var(--available-width)":void 0,maxHeight:n?"var(--available-height)":void 0,top:"0px",left:"0px",transform:r?"translate3d(var(--x), var(--y), 0)":"translate3d(0, -100vh, 0)",zIndex:"var(--z-index)"}}}var Ie=W("popover").parts("arrow","arrowTip","anchor","trigger","indicator","positioner","content","title","description","closeTrigger"),u=Ie.build(),i=z({getAnchorId:e=>{var r;return((r=e.ids)==null?void 0:r.anchor)??`popover:${e.id}:anchor`},getTriggerId:e=>{var r;return((r=e.ids)==null?void 0:r.trigger)??`popover:${e.id}:trigger`},getContentId:e=>{var r;return((r=e.ids)==null?void 0:r.content)??`popover:${e.id}:content`},getPositionerId:e=>{var r;return((r=e.ids)==null?void 0:r.positioner)??`popover:${e.id}:popper`},getArrowId:e=>{var r;return((r=e.ids)==null?void 0:r.arrow)??`popover:${e.id}:arrow`},getTitleId:e=>{var r;return((r=e.ids)==null?void 0:r.title)??`popover:${e.id}:title`},getDescriptionId:e=>{var r;return((r=e.ids)==null?void 0:r.description)??`popover:${e.id}:desc`},getCloseTriggerId:e=>{var r;return((r=e.ids)==null?void 0:r.closeTrigger)??`popover:${e.id}:close`},getAnchorEl:e=>i.getById(e,i.getAnchorId(e)),getTriggerEl:e=>i.getById(e,i.getTriggerId(e)),getContentEl:e=>i.getById(e,i.getContentId(e)),getPositionerEl:e=>i.getById(e,i.getPositionerId(e)),getTitleEl:e=>i.getById(e,i.getTitleId(e)),getDescriptionEl:e=>i.getById(e,i.getDescriptionId(e)),getFocusableEls:e=>_(i.getContentEl(e)),getFirstFocusableEl:e=>i.getFocusableEls(e)[0]});function Se(e,r,t){const n=e.matches("open"),o=e.context.currentPlacement,s=e.context.currentPortalled,d=e.context.renderedElements,a=we({...e.context.positioning,placement:o});return{portalled:s,open:n,setOpen(l){l!==n&&r(l?"OPEN":"CLOSE")},reposition(l={}){r({type:"POSITIONING.SET",options:l})},getArrowProps(){return t.element({id:i.getArrowId(e.context),...u.arrow.attrs,dir:e.context.dir,style:a.arrow})},getArrowTipProps(){return t.element({...u.arrowTip.attrs,dir:e.context.dir,style:a.arrowTip})},getAnchorProps(){return t.element({...u.anchor.attrs,dir:e.context.dir,id:i.getAnchorId(e.context)})},getTriggerProps(){return t.button({...u.trigger.attrs,dir:e.context.dir,type:"button","data-placement":o,id:i.getTriggerId(e.context),"aria-haspopup":"dialog","aria-expanded":n,"data-state":n?"open":"closed","aria-controls":i.getContentId(e.context),onPointerDown(l){j()&&l.currentTarget.focus()},onClick(l){l.defaultPrevented||r("TOGGLE")},onBlur(l){r({type:"TRIGGER_BLUR",target:l.relatedTarget})}})},getIndicatorProps(){return t.element({...u.indicator.attrs,dir:e.context.dir,"data-state":n?"open":"closed"})},getPositionerProps(){return t.element({id:i.getPositionerId(e.context),...u.positioner.attrs,dir:e.context.dir,style:a.floating})},getContentProps(){return t.element({...u.content.attrs,dir:e.context.dir,id:i.getContentId(e.context),tabIndex:-1,role:"dialog",hidden:!n,"data-state":n?"open":"closed","data-expanded":V(n),"aria-labelledby":d.title?i.getTitleId(e.context):void 0,"aria-describedby":d.description?i.getDescriptionId(e.context):void 0,"data-placement":o})},getTitleProps(){return t.element({...u.title.attrs,id:i.getTitleId(e.context),dir:e.context.dir})},getDescriptionProps(){return t.element({...u.description.attrs,id:i.getDescriptionId(e.context),dir:e.context.dir})},getCloseTriggerProps(){return t.button({...u.closeTrigger.attrs,dir:e.context.dir,id:i.getCloseTriggerId(e.context),type:"button","aria-label":"close",onClick(l){l.defaultPrevented||r("CLOSE")}})}}}function De(e){const r=S(e);return G({id:"popover",initial:r.open?"open":"closed",context:{closeOnInteractOutside:!0,closeOnEscape:!0,autoFocus:!0,modal:!1,portalled:!0,positioning:{placement:"bottom",...r.positioning},currentPlacement:void 0,...r,renderedElements:{title:!0,description:!0}},computed:{currentPortalled:t=>!!t.modal||!!t.portalled},watch:{open:["toggleVisibility"]},entry:["checkRenderedElements"],states:{closed:{on:{"CONTROLLED.OPEN":{target:"open",actions:["setInitialFocus"]},TOGGLE:[{guard:"isOpenControlled",actions:["invokeOnOpen"]},{target:"open",actions:["invokeOnOpen","setInitialFocus"]}],OPEN:[{guard:"isOpenControlled",actions:["invokeOnOpen"]},{target:"open",actions:["invokeOnOpen","setInitialFocus"]}]}},open:{activities:["trapFocus","preventScroll","hideContentBelow","trackPositioning","trackDismissableElement","proxyTabFocus"],on:{"CONTROLLED.CLOSE":{target:"closed",actions:["setFinalFocus"]},CLOSE:[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"closed",actions:["invokeOnClose","setFinalFocus"]}],TOGGLE:[{guard:"isOpenControlled",actions:["invokeOnClose"]},{target:"closed",actions:["invokeOnClose"]}],"POSITIONING.SET":{actions:"reposition"}}}}},{guards:{isOpenControlled:t=>!!t["open.controlled"]},activities:{trackPositioning(t){t.currentPlacement=t.positioning.placement;const n=i.getAnchorEl(t)??i.getTriggerEl(t);return F(n,()=>i.getPositionerEl(t),{...t.positioning,defer:!0,onComplete(s){t.currentPlacement=s.placement}})},trackDismissableElement(t,n,{send:o}){const s=()=>i.getContentEl(t);let d=!0;return ie(s,{pointerBlocking:t.modal,exclude:i.getTriggerEl(t),defer:!0,onEscapeKeyDown(a){var l;(l=t.onEscapeKeyDown)==null||l.call(t,a),!t.closeOnEscape&&a.preventDefault()},onInteractOutside(a){var l;(l=t.onInteractOutside)==null||l.call(t,a),!a.defaultPrevented&&(d=!(a.detail.focusable||a.detail.contextmenu),t.closeOnInteractOutside||a.preventDefault())},onPointerDownOutside:t.onPointerDownOutside,onFocusOutside:t.onFocusOutside,persistentElements:t.persistentElements,onDismiss(){o({type:"CLOSE",src:"interact-outside",restoreFocus:d})}})},proxyTabFocus(t){return t.modal||!t.portalled?void 0:H(()=>i.getContentEl(t),{triggerElement:i.getTriggerEl(t),defer:!0,onFocus(o){o.focus({preventScroll:!0})}})},hideContentBelow(t){return t.modal?oe(()=>[i.getContentEl(t),i.getTriggerEl(t)],{defer:!0}):void 0},preventScroll(t){if(t.modal)return ne(i.getDoc(t))},trapFocus(t){return t.modal?re(()=>i.getContentEl(t),{initialFocus:()=>I({root:i.getContentEl(t),getInitialEl:t.initialFocusEl,enabled:t.autoFocus})}):void 0}},actions:{reposition(t,n){const o=i.getAnchorEl(t)??i.getTriggerEl(t);F(o,()=>i.getPositionerEl(t),{...t.positioning,...n.options,defer:!0,listeners:!1,onComplete(d){t.currentPlacement=d.placement}})},checkRenderedElements(t){h(()=>{Object.assign(t.renderedElements,{title:!!i.getTitleEl(t),description:!!i.getDescriptionEl(t)})})},setInitialFocus(t){t.modal||h(()=>{const n=I({root:i.getContentEl(t),getInitialEl:t.initialFocusEl,enabled:t.autoFocus});n==null||n.focus({preventScroll:!0})})},setFinalFocus(t,n){var s;const o=n.restoreFocus??((s=n.previousEvent)==null?void 0:s.restoreFocus);o!=null&&!o||h(()=>{const d=i.getTriggerEl(t);d==null||d.focus({preventScroll:!0})})},invokeOnOpen(t){var n;(n=t.onOpenChange)==null||n.call(t,{open:!0})},invokeOnClose(t){var n;(n=t.onOpenChange)==null||n.call(t,{open:!1})},toggleVisibility(t,n,{send:o}){o({type:t.open?"CONTROLLED.OPEN":"CONTROLLED.CLOSE",previousEvent:n})}}})}K()(["autoFocus","closeOnEscape","closeOnInteractOutside","dir","getRootNode","id","ids","initialFocusEl","modal","onEscapeKeyDown","onFocusOutside","onInteractOutside","onOpenChange","onPointerDownOutside","open.controlled","open","persistentElements","portalled","positioning"]);export{Ie as a,Se as c,De as m};
